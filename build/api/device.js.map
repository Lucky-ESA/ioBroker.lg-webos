{
  "version": 3,
  "sources": ["../../src/api/device.ts"],
  "sourcesContent": ["import type { MulticastDNS } from \"multicast-dns\";\nimport mdns from \"multicast-dns\";\nimport { EventEmitter } from \"node:events\";\nimport { WebSocket } from \"partysocket\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport type { ConfigDevice, Device, pointerJson, respCheck } from \"../types/device\";\nimport type { handshake } from \"../types/handshake\";\nimport type { AxiosResponse } from \"../types/object\";\nimport type { LGResponse } from \"../types/response\";\nimport { handshake_notpaired, handshake_paired } from \"./handshake\";\nimport { Endpoint, forbidden_ip, promisedWol, promisedWolAddress, webSocketClass } from \"./helper\";\nimport { creatObjects } from \"./objects\";\nimport { axoisRrequest } from \"./request\";\nimport { updateStates } from \"./states\";\n\n/**\n * Device handler\n */\nexport class TVHandler extends EventEmitter implements Device {\n    private adapter: ioBroker.Adapter;\n    private mdn: MulticastDNS | null;\n    private ws: WebSocket | null;\n    private pointerWebSocket: WebSocket | null;\n    private isConnected: boolean;\n    private isPointerConnected: boolean;\n    private isRegistered: boolean;\n    private isFirstStart: boolean;\n    private isSubscribe: boolean;\n    private uri: string;\n    private mac: string;\n    private interval: number;\n    private luna: boolean;\n    private key: string | null;\n    private ip: string | null;\n    private dp: string | undefined;\n    private v4: Map<string, ioBroker.Message | string> = new Map<string, ioBroker.Message | string>();\n    private reqResp: [string, respCheck][] = [];\n    private objects: creatObjects;\n    private states: updateStates;\n    private errorCount: number;\n    private delayTimeout: ioBroker.Timeout | undefined;\n    private checkCallback: ioBroker.Timeout | undefined;\n    private subscribeChannel: ioBroker.Timeout | undefined;\n    private pointerCheck: ioBroker.Timeout | undefined;\n    private checkTVStatus: ioBroker.Interval | undefined;\n    private startWebSocketDelay: ioBroker.Timeout | undefined;\n    private log: boolean;\n    private pair: handshake;\n    private getRequest: axoisRrequest;\n    private socketPath: string;\n    private openPointerRequest: pointerJson;\n    private isSettings: string[] = [];\n    private isStart: boolean = false;\n    private closeWS: string = \"\";\n\n    /**\n     * Device\n     *\n     * @param iob iobroker ulits\n     * @param device adapter config\n     */\n    constructor(\n        readonly iob: ioBroker.Adapter,\n        readonly device: ConfigDevice,\n    ) {\n        super();\n        this.adapter = iob;\n        this.getRequest = new axoisRrequest();\n        this.mdn = null;\n        if (device.ws == \"ws\") {\n            this.uri = `ws://${device.ip}:3000`;\n        } else {\n            this.uri = `wss://${device.ip}:3001`;\n        }\n        this.ip = device.ip;\n        this.dp = device.dp;\n        this.mac = device.mac;\n        this.interval = device.interval;\n        this.luna = device.luna;\n        this.key = null;\n        this.isConnected = false;\n        this.isRegistered = false;\n        this.isFirstStart = true;\n        this.isSubscribe = false;\n        this.isPointerConnected = false;\n        this.ws = null;\n        this.pointerWebSocket = null;\n        this.errorCount = 0;\n        this.delayTimeout = undefined;\n        this.checkCallback = undefined;\n        this.subscribeChannel = undefined;\n        this.checkTVStatus = undefined;\n        this.pointerCheck = undefined;\n        this.startWebSocketDelay = undefined;\n        this.objects = new creatObjects(device, iob);\n        this.states = new updateStates(device, iob);\n        this.log = false;\n        this.pair = handshake_notpaired;\n        this.socketPath = \"\";\n        this.openPointerRequest = {\n            type: undefined,\n            uri: undefined,\n            payload: undefined,\n            first: undefined,\n            prefix: undefined,\n        };\n        void this.onReady();\n    }\n\n    /**\n     * Start Class\n     */\n    private async onReady(): Promise<void> {\n        await this.objects.createDevice();\n        const state = await this.adapter.getStateAsync(`${this.dp}.system.pair_code`);\n        if (state && state.val && typeof state.val === \"string\" && state.val.includes(\"aes-192-cbc\")) {\n            this.key = this.adapter.decrypt(state.val);\n            this.pair = handshake_paired;\n            this.pair[\"client-key\"] = this.key;\n            this.adapter.log.debug(`Key: ${this.key}`);\n        }\n        const respSettings = await this.adapter.getStateAsync(`${this.dp}.status.possibleSettings`);\n        if (\n            respSettings &&\n            respSettings.val &&\n            typeof respSettings.val === \"string\" &&\n            respSettings.val.startsWith(\"[\")\n        ) {\n            try {\n                const allSettings: string[] = JSON.parse(respSettings.val);\n                if (typeof allSettings === \"object\" && allSettings.length > 0) {\n                    this.isSettings = allSettings;\n                }\n            } catch (error: unknown) {\n                if (typeof error === \"string\") {\n                    this.adapter.log.error(`${error}`);\n                } else if (error instanceof Error) {\n                    this.adapter.log.error(`${error.name}: ${error.message}`);\n                }\n            }\n        }\n        const respStart = await this.adapter.getStateAsync(`${this.dp}.status.responseStart`);\n        if (respStart && respStart.val && typeof respStart.val === \"string\" && respStart.val.startsWith(\"[\")) {\n            try {\n                const allStarts: any = JSON.parse(respStart.val);\n                if (typeof allStarts === \"object\" && allStarts.length > 0) {\n                    this.isStart = true;\n                    for (const allStar of allStarts) {\n                        this.reqResp.push([\n                            allStar[0].toString(),\n                            typeof allStar[1] === \"object\" ? allStar[1] : JSON.parse(allStar[1]),\n                        ]);\n                    }\n                }\n            } catch (error: unknown) {\n                if (typeof error === \"string\") {\n                    this.adapter.log.error(`${error}`);\n                } else if (error instanceof Error) {\n                    this.adapter.log.error(`${error.name}: ${error.message}`);\n                }\n            }\n        }\n        this.adapter.log.debug(JSON.stringify(this.reqResp));\n        this.adapter.log.debug(JSON.stringify(this.isSettings));\n        this.startWebSocket();\n    }\n\n    /**\n     * Start Web Socket\n     */\n    private startWebSocket(): void {\n        this.ws = new WebSocket(this.uri, undefined, {\n            WebSocket: webSocketClass({\n                rejectUnauthorized: false,\n            }),\n            connectionTimeout: 1000,\n            minReconnectionDelay: 1000,\n            maxReconnectionDelay: 1000,\n        });\n        this.ws.addEventListener(\"message\", async message => {\n            this.errorCount = 0;\n            this.closeWS = \"\";\n            this.isConnected = true;\n            this.adapter.log.debug(`LGTV message for ${this.uri}`);\n            if (message && message.data) {\n                this.adapter.log.debug(`Message: ${JSON.stringify(message.data)}`);\n                try {\n                    const payload = JSON.parse(message.data);\n                    this.adapter.log.debug(`Payload: ${JSON.stringify(payload)}`);\n                    this.setResponseValue(payload);\n                    if (payload && payload.id) {\n                        const type = this.v4.get(payload.id);\n                        this.adapter.log.debug(`Type Response ${JSON.stringify(type)}`);\n                        if (payload.type == \"response\") {\n                            if (type == \"First\") {\n                                void this.createStateFirst(payload);\n                            } else if (type == \"Own\") {\n                                void this.ownRequest(payload);\n                            } else if (\n                                type &&\n                                this.dp &&\n                                typeof type !== \"object\" &&\n                                JSON.stringify(type).includes(this.dp)\n                            ) {\n                                void this.isSendRequest(\n                                    typeof type === \"string\" ? type : JSON.stringify(type),\n                                    payload,\n                                );\n                            } else if (typeof type === \"object\" && type.callback) {\n                                this.adapter.sendTo(type.from, type.command, payload, type.callback);\n                            } else {\n                                void this.updateStates(payload);\n                            }\n                        } else if (payload.type == \"error\") {\n                            if (type == \"Own\") {\n                                void this.ownRequest(payload);\n                            } else if (typeof type === \"object\" && type.callback) {\n                                this.adapter.sendTo(type.from, type.command, payload, type.callback);\n                            }\n                            if (payload.error == \"403 cancelled\") {\n                                void this.updateStates({ type: \"error\", id: \"\", payload: { appId: \"\" } });\n                            }\n                            this.adapter.log.debug(`Error Response ${payload.error}`);\n                        } else if (type == \"register\") {\n                            if (payload.type == \"response\" || payload.type == \"PROMPT\") {\n                                this.adapter.log.warn(\n                                    `Starting pairing with the TV. Please confirm the pairing on the TV.`,\n                                );\n                            } else if (\n                                payload.type == \"registered\" &&\n                                payload.payload &&\n                                payload.payload[\"client-key\"]\n                            ) {\n                                this.adapter.log.debug(`${payload.payload[\"client-key\"]}`);\n                                this.adapter.log.debug(`${this.key}`);\n                                if (!this.key || this.key != payload.payload[\"client-key\"]) {\n                                    this.key = payload.payload[\"client-key\"];\n                                    if (typeof this.key === \"string\") {\n                                        if (this.pair[\"client-key\"] == null) {\n                                            this.pair = handshake_paired;\n                                        }\n                                        this.pair[\"client-key\"] = this.key;\n                                        await this.adapter.setState(`${this.dp}.system.pair_code`, {\n                                            val: this.adapter.encrypt(this.key),\n                                            ack: true,\n                                        });\n                                        this.isRegistered = true;\n                                        void this.getDeviceInfos();\n                                    }\n                                } else {\n                                    this.isRegistered = true;\n                                    void this.getDeviceInfos();\n                                }\n                            }\n                        }\n                        if (type != \"register\" && payload.type != \"PROMPT\") {\n                            this.v4.delete(payload.id);\n                        }\n                        this.adapter.log.debug(`Count: ${this.v4.size}`);\n                        if (this.v4.size > 20) {\n                            this.v4.clear();\n                        }\n                    }\n                } catch (error: unknown) {\n                    if (typeof error === \"string\") {\n                        this.adapter.log.error(`Message: ${error}`);\n                    } else if (error instanceof Error) {\n                        this.adapter.log.error(`Message: ${error.name}: ${error.message}`);\n                    }\n                }\n                void this.setResponse();\n            }\n        });\n\n        this.ws.addEventListener(\"error\", (error: Error) => {\n            this.closeWS = \"\";\n            if (error && error.message) {\n                this.adapter.log.debug(`Error: ${error.message}`);\n                if (error.message == \"TIMEOUT\") {\n                    if (this.errorCount > 15) {\n                        void this.startWatching();\n                        this.adapter.log.info(`Devices ${this.ip} likely offline. Start MDNS monitoring.`);\n                        this.errorCount = 16;\n                    }\n                }\n            }\n            this.checkOpenMessage();\n            this.isConnected = false;\n            this.isRegistered = false;\n            ++this.errorCount;\n        });\n\n        this.ws.addEventListener(\"open\", open => {\n            if (this.closeWS == \"Try Again Later (EWS)\") {\n                this.adapter.log.debug(`LGTV ${this.uri} shutdown`);\n                return;\n            }\n            this.isConnected = true;\n            void this.updateStatus(true);\n            this.errorCount = 0;\n            this.adapter.log.info(`LGTV ${this.uri} opened`);\n            if (open && open.returnValue) {\n                this.adapter.log.info(`Open: ${JSON.stringify(open.returnValue)}`);\n            }\n            if (typeof this.key !== \"string\" || !this.isRegistered) {\n                if (!this.key || this.key == \"\") {\n                    this.adapter.log.warn(`Start pairing!!!`);\n                }\n                this.sendCommand(\"register\", undefined, this.pair);\n            }\n        });\n\n        this.ws.addEventListener(\"close\", close => {\n            if (this.closeWS == \"Try Again Later (EWS)\") {\n                this.adapter.log.debug(`LGTV ${this.uri} shutdown`);\n                return;\n            }\n            this.isConnected = false;\n            this.isRegistered = false;\n            void this.updateStatus(false);\n            this.adapter.log.debug(`LGTV ${this.uri} closed`);\n            if (close && close.reason) {\n                this.adapter.log.debug(`Close: ${JSON.stringify(close.reason)}`);\n                this.closeWS = JSON.stringify(close.reason);\n            }\n            this.checkOpenMessage();\n        });\n    }\n\n    /**\n     * Start Pointer Web Socket\n     */\n    private startpointerWebSocket(): void {\n        if (this.socketPath == \"\") {\n            this.adapter.log.warn(`Cannot found cursor address!!!`);\n            return;\n        }\n        this.pointerWebSocket = new WebSocket(this.socketPath, undefined, {\n            WebSocket: webSocketClass({\n                rejectUnauthorized: false,\n            }),\n            connectionTimeout: 2000,\n            minReconnectionDelay: 10000,\n            maxReconnectionDelay: 10000,\n        });\n\n        this.pointerWebSocket.addEventListener(\"message\", message => {\n            this.adapter.log.debug(`LGTV cursor connection ${this.uri} message`);\n            this.isPointerConnected = true;\n            if (message && message.data) {\n                this.adapter.log.debug(`Message: ${JSON.stringify(message.data)}`);\n            }\n        });\n\n        this.pointerWebSocket.addEventListener(\"error\", async (error: Error) => {\n            this.isPointerConnected = false;\n            if (this.isPointerConnected) {\n                await this.updatePointerStatus(false);\n            }\n            this.adapter.log.debug(`LGTV cursor connection ${this.uri} error`);\n            if (error && error.message) {\n                this.adapter.log.debug(`Error: ${error.message}`);\n            }\n        });\n\n        this.pointerWebSocket.addEventListener(\"open\", async open => {\n            this.isPointerConnected = true;\n            this.getPointerCheck();\n            await this.updatePointerStatus(true);\n            this.adapter.log.debug(`LGTV cursor connection ${this.uri} opened`);\n            if (open && open.returnValue) {\n                this.adapter.log.info(`Open cursor: ${JSON.stringify(open.returnValue)}`);\n            }\n            if (this.openPointerRequest.first && this.openPointerRequest.type && this.openPointerRequest.uri) {\n                this.sendCommand(\n                    this.openPointerRequest.type,\n                    this.openPointerRequest.uri,\n                    this.openPointerRequest.payload,\n                    this.openPointerRequest.first,\n                    this.openPointerRequest.prefix,\n                );\n            }\n        });\n\n        this.pointerWebSocket.addEventListener(\"close\", async close => {\n            await this.updatePointerStatus(false);\n            if (this.isPointerConnected) {\n                await this.updatePointerStatus(false);\n            }\n            this.adapter.log.debug(`LGTV cursor connection ${this.uri} closed`);\n            if (close && close && close.reason) {\n                this.adapter.log.debug(`Close cursor: ${JSON.stringify(close.reason)}`);\n            }\n        });\n    }\n\n    /**\n     * Close pointer websocket after 5 minutes\n     */\n    private getPointerCheck(): void {\n        this.pointerCheck && this.adapter.clearTimeout(this.pointerCheck);\n        this.pointerCheck = this.adapter.setTimeout(\n            () => {\n                if (this.pointerWebSocket) {\n                    this.pointerWebSocket.close();\n                    this.pointerWebSocket = null;\n                }\n                this.pointerCheck = undefined;\n                void this.updatePointerStatus(false);\n            },\n            60 * 1000 * 5,\n        );\n    }\n\n    /**\n     * Create States after restart\n     *\n     * @param val LGResponse\n     */\n    private async ownRequest(val: LGResponse): Promise<void> {\n        await this.adapter.setState(`${this.dp}.remote.own_request.response`, { val: JSON.stringify(val), ack: true });\n        await this.setAckFlag(`${this.dp}.remote.own_request.request`);\n    }\n\n    /**\n     * Set ack flag\n     *\n     * @param objectId ioBroker object id\n     */\n    private async isSendRequest(objectId: string, res: LGResponse): Promise<void> {\n        await this.setAckFlag(objectId);\n        if (\n            objectId != \"\" &&\n            objectId.includes(\"keys.screenshot\") &&\n            res.payload &&\n            res.payload.returnValue &&\n            res.payload.imageUri != \"\"\n        ) {\n            void this.saveScreenshot(res.payload.imageUri as string);\n        }\n    }\n\n    /**\n     * Save screenshots\n     *\n     * @param url Icon URL\n     */\n    private async saveScreenshot(url: string): Promise<void> {\n        this.adapter.log.debug(`Screenshot: ${url}`);\n        const resp: AxiosResponse = await this.getRequest.get(url);\n        if (resp && resp.data) {\n            const file = url.split(\".\");\n            const ext = file.pop();\n            const filename = new Date().getTime();\n            await this.adapter.writeFileAsync(`${this.adapter.namespace}`, `screenshot/${filename}.${ext}`, resp.data);\n        } else {\n            this.adapter.log.error(JSON.stringify(resp));\n        }\n    }\n\n    /**\n     * Set Online Status\n     *\n     * @param val boolean\n     */\n    private async updateStatus(val: boolean): Promise<void> {\n        await this.adapter.setState(`${this.dp}.status.online`, { val: val, ack: true });\n        if (!val) {\n            const available = this.getRespRequestFind(Endpoint.GET_POWER_STATE, \"uri\");\n            if (available && available[1] && available[1].response == \"response\") {\n                await this.adapter.setState(`${this.dp}.status.powerState`, { val: \"unknown\", ack: true });\n            }\n        }\n        this.emit(\"update\", this.dp, val);\n    }\n\n    /**\n     * Set Online Status for cursor connection\n     *\n     * @param val boolean\n     */\n    private async updatePointerStatus(val: boolean): Promise<void> {\n        await this.adapter.setState(`${this.dp}.status.pointerConnection`, { val: val, ack: true });\n    }\n\n    /**\n     * Save response\n     */\n    private async setResponse(): Promise<void> {\n        await this.adapter.setState(`${this.dp}.status.responseStart`, {\n            val: JSON.stringify(this.reqResp),\n            ack: true,\n        });\n    }\n\n    /**\n     * Save first response\n     */\n    private async setFirstResponse(): Promise<void> {\n        await this.sleep(5000);\n        await this.adapter.setState(`${this.dp}.status.responseStart`, {\n            val: JSON.stringify(this.reqResp),\n            ack: true,\n        });\n        const settings = [];\n        for (const r of this.reqResp) {\n            if (\n                r[1].settings != \"No Value\" &&\n                r[1].settings != \"\" &&\n                r[1].category == \"picture\" &&\n                !r[1].settings.includes(\",\")\n            ) {\n                settings.push(r[1].settings);\n            }\n        }\n        this.isSettings = settings;\n        await this.adapter.setState(`${this.dp}.status.possibleSettings`, { val: JSON.stringify(settings), ack: true });\n    }\n\n    /**\n     * Create States after restart\n     *\n     * @param val LGResponse\n     */\n    private async createStateFirst(val: LGResponse): Promise<void> {\n        if (val.payload.devices) {\n            await this.objects.createInput(val);\n            this.states.updateInuptValue(val);\n        } else if (val.payload.volumeStatus) {\n            await this.objects.createOutput(val);\n        } else if (val.payload.scenario) {\n            await this.objects.createOutputOld(val);\n        } else if (val.payload.channelList) {\n            await this.objects.createChannelList(val);\n        } else if (val.payload.product_name) {\n            await this.objects.createSystem(val);\n        } else if (typeof val.payload.settings === \"object\") {\n            await this.objects.createSettings(val);\n        } else if (val.payload.launchPoints) {\n            await this.objects.createLaunch(val);\n        } else if (val.payload.features || val.payload.configs) {\n            await this.objects.createFeatures(val);\n            if (\n                (val.payload.features && val.payload.features[\"3d\"]) ||\n                (val.payload.configs && val.payload.configs[\"tv.model.3dSupportType\"] == \"3D\")\n            ) {\n                let first: string | null = null;\n                if (this.isFirstStart) {\n                    first = \"First\";\n                }\n                this.sendCommand(\"subscribe\", Endpoint.GET_3D_STATUS, null, first);\n            }\n        } else if (val.payload.apps) {\n            await this.objects.createApps(val);\n        } else if (val.payload.socketPath != null && val.payload.socketPath != \"\") {\n            this.socketPath = val.payload.socketPath;\n            await this.objects.createPointerConnection();\n        } else if (val.payload.state) {\n            await this.objects.createPowerState(val);\n        } else if (val.payload.channel) {\n            await this.states.updateChannel(val);\n        } else if (val.payload.channelTypeName) {\n            await this.states.updateChannelSwitch(val);\n        } else if (val.payload.appId && val.payload.appId != \"\") {\n            await this.states.updateAppId(val);\n        }\n    }\n\n    /**\n     * Update States\n     *\n     * @param val LGResponse\n     */\n    private async updateStates(val: LGResponse): Promise<void> {\n        this.adapter.log.debug(`Update: ${JSON.stringify(val)}`);\n        if (val.payload.appId != null && val.payload.appId != \"\") {\n            await this.states.updateAppId(val);\n            if (val.payload.appId == \"com.webos.app.livetv\") {\n                this.subscribeChannel = this.adapter.setTimeout(async () => {\n                    this.sendCommand(\"subscribe\", Endpoint.GET_CURRENT_CHANNEL, null, null);\n                    await this.sleep(100);\n                    this.sendCommand(\"subscribe\", Endpoint.GET_CURRENT_PROGRAM_INFO, null, null);\n                    this.isSubscribe = true;\n                    this.subscribeChannel = undefined;\n                }, 3000);\n            } else {\n                await this.states.cleanUpChannel();\n                if (this.isSubscribe) {\n                    this.sendCommand(\"unsubscribe\", Endpoint.GET_CURRENT_CHANNEL, null, null);\n                    await this.sleep(100);\n                    this.sendCommand(\"unsubscribe\", Endpoint.GET_CURRENT_PROGRAM_INFO, null, null);\n                    this.isSubscribe = false;\n                }\n                this.subscribeChannel && this.adapter.clearTimeout(this.subscribeChannel);\n                this.subscribeChannel = undefined;\n            }\n        } else if (val.payload.volumeStatus) {\n            await this.states.updateOutput(val);\n        } else if (typeof val.payload.settings === \"object\") {\n            await this.states.updateSettings(val);\n        } else if (val.payload.state) {\n            await this.states.updatePowerState(val);\n            if (val.payload.state == \"Suspend\") {\n                void this.startWatching();\n            }\n        } else if (val.payload.channel) {\n            await this.states.updateChannel(val);\n        } else if (val.payload.channelTypeName) {\n            await this.states.updateChannelSwitch(val);\n        } else if (val.payload.programId) {\n            await this.states.updateProgram(val);\n        } else if (val.payload.socketPath != null && val.payload.socketPath != \"\") {\n            this.socketPath = val.payload.socketPath;\n        } else if (val.payload.appId != null && val.payload.appId == \"\") {\n            this.isConnected = false;\n            this.isRegistered = false;\n            void this.startWatching();\n            this.adapter.log.info(`Devices ${this.ip} likely offline. Start MDNS monitoring.`);\n        } else if (val.payload.changed) {\n            await this.states.updateOutputOld(val);\n        }\n        await this.adapter.setState(`${this.dp}.remote.own_request.responseSubscribe`, {\n            val: JSON.stringify(val),\n            ack: true,\n        });\n    }\n\n    /**\n     * Request device infos\n     */\n    private async getDeviceInfos(): Promise<void> {\n        let first: string | null = null;\n        if (this.isFirstStart) {\n            first = \"First\";\n        }\n        let check: [string, respCheck] | undefined = undefined;\n        this.sendCommand(\"subscribe\", Endpoint.SEND_REGISTER, null, first);\n        await this.sleep(100);\n        check = this.getRespRequestFind(Endpoint.GET_SERVICES, \"uri\");\n        if (check == undefined || (check[1] && check[1].response == \"response\")) {\n            this.sendCommand(\"request\", Endpoint.GET_SERVICES, null, first);\n            await this.sleep(100);\n        }\n        this.sendCommand(\"request\", Endpoint.GET_AUDIO_STATUS, null, first);\n        await this.sleep(100);\n        this.sendCommand(\"subscribe\", Endpoint.GET_APPS_ALL, null, first);\n        await this.sleep(100);\n        this.sendCommand(\"request\", Endpoint.GET_SOFTWARE_INFO, null, first);\n        await this.sleep(100);\n        check = this.getRespRequestFind(Endpoint.GET_SYSTEM_INFO, \"uri\");\n        if (check == undefined || (check[1] && check[1].response == \"response\")) {\n            this.sendCommand(\"request\", Endpoint.GET_SYSTEM_INFO, null, first);\n            await this.sleep(100);\n        }\n        this.sendCommand(\"request\", Endpoint.GET_CHANNEL_INFO, null, first);\n        await this.sleep(100);\n        check = this.getRespRequestFind(Endpoint.GET_POWER_STATE, \"uri\");\n        if (check == undefined || (check[1] && check[1].response == \"response\")) {\n            this.sendCommand(\"subscribe\", Endpoint.GET_POWER_STATE, null, first);\n            await this.sleep(100);\n        }\n        check = this.getRespRequestFind(Endpoint.GET_CONFIGS, \"uri\");\n        if (check == undefined || (check[1] && check[1].response == \"response\")) {\n            this.sendCommand(\n                \"subscribe\",\n                Endpoint.GET_CONFIGS,\n                { configNames: [\"tv.model.*\", \"tv.rmm.*\", \"tv.hw.*\", \"system.*\", \"tv.config.*\", \"tv.conti.*\"] },\n                first,\n            );\n            await this.sleep(100);\n        }\n        await this.sleep(100);\n        this.sendCommand(\"subscribe\", Endpoint.GET_CURRENT_CHANNEL, null, first);\n        await this.sleep(100);\n        this.sendCommand(\"subscribe\", Endpoint.GET_CURRENT_PROGRAM_INFO, null, first);\n        await this.sleep(100);\n        this.sendCommand(\"subscribe\", Endpoint.GET_SOUND_OUTPUT, null, first);\n        await this.sleep(100);\n        this.sendCommand(\"subscribe\", Endpoint.GET_VOLUME, null, first);\n        await this.sleep(100);\n        check = this.getRespRequestFind(Endpoint.GET_TV_TIME, \"uri\");\n        if (check == undefined || (check[1] && check[1].response == \"response\")) {\n            this.sendCommand(\"request\", Endpoint.GET_TV_TIME, null, first);\n            await this.sleep(100);\n        }\n        this.sendCommand(\"request\", Endpoint.GET_TV_CHANNELS, null, first);\n        await this.sleep(100);\n        this.sendCommand(\"subscribe\", Endpoint.GET_INPUTS, null, first);\n        await this.sleep(100);\n        this.sendCommand(\"request\", Endpoint.INPUT_SOCKET, null, first);\n        await this.sleep(100);\n        check = this.getRespRequestFind(Endpoint.GET_TV_TIME, \"uri\");\n        if (check == undefined || (check[1] && check[1].response == \"response\")) {\n            this.sendCommand(\"subscribe\", Endpoint.LIST_DEVICES, null, first);\n            await this.sleep(100);\n        }\n        this.sendCommand(\"subscribe\", Endpoint.GET_APPS, null, first);\n        await this.sleep(100);\n        this.sendCommand(\n            \"subscribe\",\n            Endpoint.GET_SYSTEM_SETTINGS,\n            { category: \"network\", keys: [\"deviceName\"] },\n            first,\n        );\n        await this.sleep(100);\n        this.sendCommand(\n            \"subscribe\",\n            Endpoint.GET_SYSTEM_SETTINGS,\n            { category: \"network\", keys: [\"wolwowlOnOff\"] },\n            first,\n        );\n        await this.sleep(100);\n        /**\n        this.sendCommand(\"subscribe\", Endpoint.GET_APP_STATUS, null, first);\n        await this.sleep(100);\n        this.sendCommand(\n            \"subscribe\",\n            Endpoint.GET_SYSTEM_SETTINGS,\n            { category: \"option\", keys: [\"audioGuidance\"] },\n            first,\n        );\n        await this.sleep(100);\n        this.sendCommand(\n            \"subscribe\",\n            Endpoint.GET_SYSTEM_SETTINGS,\n            { category: \"sound\", keys: [\"soundOutput\", \"soundMode\"] },\n            first,\n        );\n        await this.sleep(100);\n        this.sendCommand(\n            \"subscribe\",\n            Endpoint.GET_SYSTEM_SETTINGS,\n            {\n                category: \"time\",\n                keys: [\"timeZone\"],\n            },\n            first,\n        );\n        await this.sleep(100);\n         */\n        const keys = [\n            \"contrast\",\n            \"backlight\",\n            \"brightness\",\n            \"color\",\n            \"energySaving\",\n            \"pictureMode\",\n            \"sharpness\",\n            \"dynamicContrast\",\n            \"peakBrightness\",\n            \"gamma\",\n            \"motionEyeCare\",\n            \"colorGamut\",\n            \"hdrDynamicToneMapping\",\n            \"blackLevel\",\n            \"realCinema\",\n            \"tint\",\n            \"noiseReduction\",\n            \"mpegNoiseReduction\",\n            \"smoothGradation\",\n            \"dynamicColor\",\n            \"eyeComfortMode\",\n        ];\n        if (this.isSettings.length > 0) {\n            this.sendCommand(\n                \"subscribe\",\n                Endpoint.GET_SYSTEM_SETTINGS,\n                {\n                    category: \"picture\",\n                    keys: this.isSettings,\n                },\n                first,\n            );\n            await this.sleep(100);\n        } else if (this.reqResp && this.reqResp.length > 0) {\n            for (const key of keys) {\n                this.sendCommand(\n                    \"subscribe\",\n                    Endpoint.GET_SYSTEM_SETTINGS,\n                    {\n                        category: \"picture\",\n                        keys: [key],\n                    },\n                    first,\n                );\n                await this.sleep(100);\n            }\n        }\n        this.sendCommand(\"subscribe\", Endpoint.GET_CURRENT_APP_INFO, null, first);\n        await this.sleep(100);\n        if (this.isFirstStart) {\n            void this.setFirstResponse();\n        }\n        this.isFirstStart = false;\n        if (this.interval > 0) {\n            this.startCheckStatus(true);\n        }\n    }\n\n    /**\n     * Check status TV disabled/enabled\n     */\n    private startCheckStatus(start: boolean): void {\n        this.checkTVStatus && this.adapter.clearInterval(this.checkTVStatus);\n        this.checkTVStatus = undefined;\n        if (start) {\n            this.checkTVStatus = this.adapter.setInterval(() => {\n                const available = this.getRespRequestFind(Endpoint.GET_POWER_STATE, \"uri\");\n                if (available && available[1] && available[1].response == \"response\") {\n                    this.sendCommand(\"request\", Endpoint.GET_POWER_STATE, null, null);\n                } else {\n                    const tv_time = this.getRespRequestFind(Endpoint.GET_TV_TIME, \"uri\");\n                    if (tv_time && tv_time[1] && tv_time[1].response == \"response\") {\n                        this.sendCommand(\"request\", Endpoint.GET_TV_TIME, null, null);\n                    } else {\n                        this.adapter.log.debug(`No request works!!!`);\n                    }\n                }\n            }, this.interval * 1000);\n        }\n    }\n\n    /**\n     * Send Callback\n     *\n     * @param obj Message\n     */\n    public sendObjCallback(obj: ioBroker.Message, message: any): void {\n        if (obj.callback) {\n            this.adapter.sendTo(obj.from, obj.command, message, obj.callback);\n        }\n    }\n\n    /**\n     * Start MDNS Service\n     */\n    private async startWatching(): Promise<void> {\n        if (this.ws) {\n            this.ws.close();\n            this.ws = null;\n        }\n        if (this.pointerWebSocket) {\n            this.pointerWebSocket.close();\n            this.pointerWebSocket = null;\n        }\n        this.isSubscribe = false;\n        void this.updateStatus(false);\n        void this.updatePointerStatus(false);\n        this.checkOpenMessage();\n        this.startCheckStatus(false);\n        this.v4.clear();\n        this.closeWS = \"\";\n        await this.sleep(3000);\n        this.startMulticast();\n    }\n\n    /**\n     * Start MDNS Service\n     */\n    private startMulticast(): void {\n        this.startWebSocketDelay && this.adapter.clearTimeout(this.startWebSocketDelay);\n        this.startWebSocketDelay = undefined;\n        if (!this.mdn) {\n            this.mdn = mdns();\n            this.mdn.query({\n                questions: [\n                    {\n                        name: \"_services._dns-sd._udp.local\",\n                        type: \"PTR\",\n                    },\n                ],\n            });\n            this.adapter.log.debug(`Watching response!`);\n            this.mdn.on(\"response\", (response: { answers: any[]; additionals: any[]; id: number }) => {\n                if (this.log) {\n                    this.adapter.log.info(`MDN: ${JSON.stringify(response)}`);\n                }\n                const device = response.answers.find(dev => dev.data == this.ip);\n                let isOnline = false;\n                if (device != undefined) {\n                    if (device.type == \"A\" || device.type == \"AAAA\") {\n                        if (device.flush) {\n                            isOnline = true;\n                        }\n                    }\n                } else {\n                    const oldDevice = response.additionals.find(dev => dev.data == this.ip);\n                    if (oldDevice != undefined) {\n                        if (oldDevice.type == \"A\" || oldDevice.type == \"AAAA\") {\n                            if (response.id > 0) {\n                                isOnline = true;\n                            }\n                        }\n                    }\n                }\n                if (isOnline) {\n                    this.adapter.log.info(`Found device ${this.ip}`);\n                    this.mdn?.destroy();\n                    this.mdn = null;\n                    this.delayStartWebSocket();\n                }\n            });\n        }\n    }\n\n    /**\n     * Start WebSocket\n     */\n    private delayStartWebSocket(): void {\n        this.startWebSocketDelay && this.adapter.clearTimeout(this.startWebSocketDelay);\n        this.startWebSocketDelay = this.adapter.setTimeout(() => {\n            this.startWebSocket();\n            void this.updateStatus(true);\n            this.startWebSocketDelay = undefined;\n        }, 3 * 1000);\n    }\n\n    /**\n     * Sends a alert message\n     *\n     * @param id ioBroker object id\n     * @param type Message type\n     * @param uri Endpoint\n     * @param payload Payload data\n     * @param prefix - URI prefix\n     */\n    public async MessageHandler(\n        id: string,\n        type: string,\n        uri?: string,\n        payload?: any,\n        prefix = `ssap://`,\n    ): Promise<void> {\n        this.adapter.log.debug(JSON.stringify({ id: id, type: type, uri: uri, payload: payload, prefix: prefix }));\n        let dp_message = \"createToast\";\n        let dp_close = \"closeToast\";\n        let attribute = \"toastId\";\n        if (type === \"createAlert\" || type === \"closeAlert\") {\n            dp_message = \"createAlert\";\n            dp_close = \"closeAlert\";\n            attribute = \"alertId\";\n        }\n        const obj: any = await this.adapter.getObjectAsync(`${this.dp}.remote.notify.${dp_close}`);\n        if (obj) {\n            await this.setAckFlag(id);\n            const messageId = await this.sendPromiseCommand(\"request\", uri, payload, prefix);\n            this.adapter.log.debug(`MessageId: ${JSON.stringify(messageId)}`);\n            if (type === dp_message) {\n                if (messageId && messageId.payload && messageId.payload[attribute]) {\n                    obj.common.states[messageId.payload[attribute]] = payload.message;\n                }\n            } else {\n                if (obj.common.states[payload[attribute]]) {\n                    delete obj.common.states[payload[attribute]];\n                }\n            }\n            await this.adapter.setObject(`${this.dp}.remote.notify.${dp_close}`, obj);\n            await this.adapter.setState(`${this.dp}.remote.notify.${dp_close}`, { val: \"no\", ack: true });\n        }\n    }\n\n    /**\n     * Sends a message\n     *\n     * @param id ioBroker object id\n     * @param type Message type\n     * @param uri Endpoint\n     * @param payload Payload data\n     * @param prefix - URI prefix\n     */\n    public request(id: string, type: string, uri?: string, payload?: any, prefix = `ssap://`): void {\n        this.adapter.log.debug(JSON.stringify({ id: id, type: type, uri: uri, payload: payload, prefix: prefix }));\n        if (!this.isConnected || !this.isRegistered) {\n            this.adapter.log.warn(`Device is offline or disconneted!!`);\n            return;\n        }\n        if (type == \"pointer\") {\n            void this.sendPointer(id, type, uri, payload, prefix);\n        } else {\n            this.sendCommand(type, uri, payload, id, prefix);\n        }\n    }\n\n    /**\n     * Wake on lan\n     *\n     * @param id ioBroker object id\n     */\n    public async wol(id: string): Promise<void> {\n        if (this.ip && this.mac) {\n            const val = await promisedWol(this.mac);\n            if (val) {\n                await this.adapter.setState(id, { ack: true });\n                this.adapter.log.info(`Send wol: ${this.mac} - ${this.ip}`);\n            } else {\n                this.adapter.log.info(`Send wol error: ${val}`);\n            }\n            const address = await promisedWolAddress(this.mac, this.ip);\n            if (address) {\n                await this.adapter.setState(id, { ack: true });\n                this.adapter.log.info(`Send wol address: ${this.mac} - ${this.ip}`);\n            } else {\n                this.adapter.log.info(`Send wol address error: ${address}`);\n            }\n        }\n    }\n\n    /**\n     * Open Callback handling\n     */\n    private checkOpenMessage(): void {\n        for (const id in this.v4) {\n            const obj = this.v4.get(id);\n            if (typeof obj === \"object\" && obj.callback) {\n                this.sendObjCallback(obj, { error: \"Message close!\" });\n                this.v4.delete(id);\n            }\n        }\n    }\n\n    /**\n     * Sends a message direct\n     *\n     * @param obj Message\n     */\n    public async messageDirect(obj: ioBroker.Message): Promise<void> {\n        if (!this.isConnected || !this.isRegistered) {\n            this.sendObjCallback(obj, { error: \"Device is offline or disconneted!\" });\n            return;\n        }\n        if (obj.message.name != \"\") {\n            const ip = forbidden_ip(obj.message.name, this.adapter.FORBIDDEN_CHARS);\n            if (ip == this.dp) {\n                if (typeof obj.message.send === \"string\") {\n                    if (obj.message.connection != \"pointer\") {\n                        const resp = await this.sendDirectPromiseCommand(obj.message.send);\n                        if (resp && obj.callback) {\n                            this.sendObjCallback(obj, resp);\n                        } else {\n                            this.sendObjCallback(obj, { error: \"Unknown error\" });\n                        }\n                    } else if (obj.message.connection == \"pointer\") {\n                        if (this.pointerWebSocket) {\n                            this.pointerWebSocket.send(`${obj.message.send}\\n\\n`);\n                            this.sendObjCallback(obj, { info: \"Send message\" });\n                        } else {\n                            this.sendObjCallback(obj, { info: \"Cannot found websocket\" });\n                        }\n                    } else if (obj.callback) {\n                        this.sendObjCallback(obj, { error: \"Missing type or uri\" });\n                    }\n                } else {\n                    this.sendObjCallback(obj, { error: \"Wrong message\" });\n                }\n            } else {\n                this.sendObjCallback(obj, { error: \"Wrong IP\" });\n            }\n        } else {\n            this.sendObjCallback(obj, { error: \"Missing IP\" });\n        }\n        this.checkCallback = this.adapter.setTimeout(() => {\n            this.checkCallback = undefined;\n            this.checkOpenMessage();\n        }, 5 * 1000);\n    }\n\n    /**\n     * Sends a message\n     *\n     * @param obj Message\n     */\n    public async message(obj: ioBroker.Message): Promise<void> {\n        if (!this.isConnected || !this.isRegistered) {\n            this.sendObjCallback(obj, { error: \"Device is offline or disconneted!!!\" });\n            return;\n        }\n        if (obj.message.prefix == \"luna://\" && obj.message.type != \"pointer\") {\n            if (obj.message.uri) {\n                await this.sendLunaRequest(obj, obj.message.type, obj.message.uri, obj.message.payload);\n            }\n        } else if (obj.message.type && obj.message.uri && obj.message.type != \"pointer\") {\n            this.sendCommand(obj.message.type, obj.message.uri, obj.message.payload, obj, obj.message.prefix);\n        } else if (obj.message.type && obj.message.uri && obj.message.type == \"pointer\") {\n            if (!this.pointerWebSocket) {\n                const socketPath = await this.sendPromiseCommand(\"request\", Endpoint.INPUT_SOCKET, null);\n                if (socketPath && socketPath.payload && socketPath.payload.socketPath != \"\") {\n                    this.socketPath = socketPath.payload.socketPath;\n                    this.openPointerRequest = {\n                        type: obj.message.type,\n                        uri: obj.message.uri,\n                        payload: obj.message.payload,\n                        first: obj,\n                        prefix: obj.message.prefix,\n                    };\n                    this.startpointerWebSocket();\n                }\n            } else {\n                this.sendCommand(obj.message.type, obj.message.uri, obj.message.payload, obj, obj.message.prefix);\n                this.sendObjCallback(obj, { info: \"Send button ok\" });\n            }\n        } else if (obj.callback) {\n            this.sendObjCallback(obj, { error: \"Missing type or uri\" });\n            return;\n        }\n        this.checkCallback = this.adapter.setTimeout(() => {\n            this.checkCallback = undefined;\n            this.checkOpenMessage();\n        }, 5 * 1000);\n    }\n\n    /**\n     * Sends a Pointer message\n     *\n     * @param id ioBroker object id\n     * @param type Message type\n     * @param uri Endpoint\n     * @param payload Payload data\n     * @param prefix - URI prefix\n     */\n    private async sendPointer(\n        id: string,\n        type: string,\n        uri?: string,\n        payload?: any,\n        prefix = `ssap://`,\n    ): Promise<void> {\n        if (!this.pointerWebSocket) {\n            const socketPath = await this.sendPromiseCommand(\"request\", Endpoint.INPUT_SOCKET, null);\n            if (socketPath && socketPath.payload && socketPath.payload.socketPath != \"\") {\n                this.socketPath = socketPath.payload.socketPath;\n                this.openPointerRequest = {\n                    type: type,\n                    uri: uri,\n                    payload: payload,\n                    first: id,\n                    prefix: prefix,\n                };\n                this.startpointerWebSocket();\n            }\n        } else {\n            this.sendCommand(type, uri, payload, id, prefix);\n        }\n    }\n\n    /**\n     * Sends a own message\n     *\n     * @param type Message type\n     * @param uri Endpoint\n     * @param payload Payload data\n     * @param prefix - URI prefix\n     */\n    public async own_request(type: string, uri?: string, payload?: any, prefix = `ssap://`): Promise<void> {\n        this.adapter.log.debug(JSON.stringify({ type: type, uri: uri, payload: payload, prefix: prefix }));\n        if (prefix == \"luna://\" && type != \"pointer\") {\n            if (uri) {\n                await this.sendLunaRequest(\"Own\", type, uri, payload);\n            }\n        } else if (type != \"pointer\") {\n            this.sendCommand(type, uri, payload, \"Own\", prefix);\n        } else {\n            if (!this.pointerWebSocket) {\n                const socketPath = await this.sendPromiseCommand(\"request\", Endpoint.INPUT_SOCKET, null);\n                if (socketPath && socketPath.payload && socketPath.payload.socketPath != \"\") {\n                    this.socketPath = socketPath.payload.socketPath;\n                    this.openPointerRequest = {\n                        type: type,\n                        uri: uri,\n                        payload: payload,\n                        first: \"Own\",\n                        prefix: prefix,\n                    };\n                    this.startpointerWebSocket();\n                }\n            } else {\n                this.sendCommand(type, uri, payload, \"Own\", prefix);\n            }\n            const resp = {\n                type: \"response\",\n                id: \"no id\",\n                payload: {\n                    info: \"Send button ok\",\n                },\n            };\n            await this.ownRequest(resp);\n        }\n    }\n\n    /**\n     * Sends a message\n     *\n     * @param type types\n     * @param uri uri address\n     * @param payload pairing\n     * @param first first\n     * @param prefix prefix\n     * @returns boolean\n     */\n    private sendCommand(type: string, uri?: string, payload?: any, first?: any, prefix?: string): boolean {\n        this.adapter.log.debug(\n            `sendCommand: ${JSON.stringify({ type: type, uri: uri, payload: payload, first: first, prefix: prefix })}`,\n        );\n        // ToDo TURN_OFF_SCREEN & TURN_OFF_SCREEN_WO\n        const id = type == \"register\" ? \"register_0\" : uuidv4();\n        if (first == \"First\") {\n            const responseRequest = {\n                id: \"\",\n                type: \"\",\n                uri: \"\",\n                response: \"\",\n                error: \"\",\n                errorCode: 0,\n                errorText: \"\",\n                settings: \"No Value\",\n                subscribe: false,\n                category: \"No Value\",\n            };\n            if (payload && payload.keys) {\n                const available = this.getRespRequestFindSecond(uri ? uri : \"\", \"uri\", JSON.stringify(payload.keys));\n                if (available && available[1]) {\n                    this.removeRespCheckUuid(available[0]);\n                }\n                responseRequest.settings = payload.keys.toString();\n                responseRequest.category = payload.category;\n            } else {\n                const available = this.getRespRequestFind(uri ? uri : \"\", \"uri\");\n                if (available && available[1]) {\n                    this.removeRespCheckUuid(available[0]);\n                }\n            }\n            responseRequest.id = id;\n            responseRequest.type = type;\n            responseRequest.uri = uri ? uri : \"\";\n            this.reqResp.push([id, responseRequest]);\n        }\n        this.v4.set(id, type);\n        if (uri) {\n            this.v4.set(id, uri);\n        }\n        if (first && type != \"pointer\") {\n            this.v4.set(id, first);\n        }\n        if (this.ws == null) {\n            this.adapter.log.error(`Cannot found web socket!!!`);\n            return false;\n        }\n        if (prefix == null) {\n            prefix = \"ssap://\"; // luna://\n        }\n\n        const uri_complete = uri == null ? prefix : prefix + uri;\n        if (prefix == \"luna://\" && type != \"pointer\") {\n            void this.sendLunaRequest(first, type, uri_complete, payload);\n            this.v4.delete(id);\n        } else if (prefix == \"luna://\" && !this.luna) {\n            void this.sendLunaRequest(first, type, uri_complete, payload);\n            this.v4.delete(id);\n        } else if (type == \"unsubscribe\" || type == \"subscribe\" || type == \"request\" || type == \"register\") {\n            this.adapter.log.debug(\n                `Send Request with id ${id}, uri ${uri_complete} and request ${JSON.stringify(payload)}`,\n            );\n            this.ws.send(\n                JSON.stringify({\n                    id: id,\n                    type: type,\n                    uri: uri_complete,\n                    payload: payload,\n                }),\n            );\n        } else if (\n            type == \"pointer\" &&\n            typeof payload === \"object\" &&\n            this.pointerWebSocket &&\n            this.isPointerConnected\n        ) {\n            const message = Object.keys(payload)\n                .reduce(\n                    (all, param) => {\n                        return all.concat([`${param}:${payload[param]}`]);\n                    },\n                    [`type:${uri_complete}`],\n                )\n                .join(\"\\n\");\n            this.adapter.log.debug(`Send Request with id ${id}, uri ${uri_complete} and request ${message}\\n\\n`);\n            this.pointerWebSocket.send(`${message}\\n\\n`);\n            this.v4.delete(id);\n            this.getPointerCheck();\n            if (typeof first === \"string\" && this.dp != undefined && first.includes(this.dp)) {\n                void this.setAckFlag(first);\n            }\n        } else {\n            this.adapter.log.error(`Unknown request ${JSON.stringify(payload)} - ${type} - ${uri}`);\n        }\n        return true;\n    }\n\n    /**\n     * Sends a Luna message (this is a workaround)\n     *\n     * @param first - Object Id or message obj\n     * @param type - Request type\n     * @param uri - uri address\n     * @param params - Payload\n     */\n    private async sendLunaRequest(first: any, type: string, uri: string, params: any): Promise<void> {\n        this.adapter.log.debug(\n            `Send Luna Request with id ${first}, type ${type}, uri ${uri} and request ${JSON.stringify(params)}`,\n        );\n\n        const buttons = [{ label: \"\", onClick: uri, params: params }];\n        const payload = {\n            message: \"Update settings!\",\n            buttons: buttons,\n            onclose: { uri: uri, params: params },\n            onfail: { uri: uri, params: params },\n        };\n        const messageId = await this.sendPromiseCommand(\"request\", Endpoint.CREATE_ALERT, payload);\n        if (first == \"Own\") {\n            void this.ownRequest(messageId);\n        }\n        if (messageId && messageId.id) {\n            if (this.v4.get(messageId.id)) {\n                this.v4.delete(messageId.id);\n            }\n        }\n        if (messageId && messageId.payload && messageId.payload.alertId) {\n            const resp = await this.sendPromiseCommand(\"request\", Endpoint.CLOSE_ALERT, {\n                alertId: messageId.payload.alertId,\n            });\n            if (first == \"Own\") {\n                void this.ownRequest(resp);\n            }\n            this.adapter.log.debug(`Response Alert Luna ${JSON.stringify(resp)}`);\n            if (resp && resp.id) {\n                if (this.v4.get(resp.id)) {\n                    this.v4.delete(resp.id);\n                }\n            }\n            if (resp && resp.payload && resp.payload.returnValue) {\n                if (typeof first === \"string\" && this.dp != undefined && first.includes(this.dp)) {\n                    void this.setAckFlag(first);\n                }\n            }\n        }\n        if (typeof first == \"object\" && first.callback) {\n            this.adapter.sendTo(first.from, first.command, messageId, first.callback);\n        }\n    }\n\n    /**\n     * Sends a message with promise response\n     *\n     * @param type Type\n     * @param uri URI\n     * @param payload Payload\n     * @param prefix Prefix\n     * @returns Response\n     */\n    private async sendPromiseCommand(\n        type: string,\n        uri?: string,\n        payload?: any,\n        prefix = `ssap://`,\n    ): Promise<LGResponse> {\n        return new Promise((resolve, reject) => {\n            if (!this.isConnected || !this.isRegistered) {\n                reject;\n            }\n            const id = uuidv4();\n            this.v4.set(id, \"PromiseResponse\");\n            const listener = (event: MessageEvent): any => {\n                try {\n                    const json: LGResponse = JSON.parse(event.data.toString());\n                    if (json.id && json.id === id) {\n                        this.ws?.removeEventListener(\"message\", listener);\n                        return resolve(json);\n                    }\n                } catch {\n                    this.v4.delete(id);\n                    return reject;\n                }\n            };\n            this.ws?.addEventListener(\"message\", listener);\n            this.ws?.send(\n                JSON.stringify({\n                    id,\n                    type,\n                    uri: `${prefix}${uri}`,\n                    payload,\n                }),\n            );\n            this.adapter.setTimeout(() => {\n                this.ws?.removeEventListener(\"message\", listener);\n                this.v4.delete(id);\n                reject;\n            }, 1000 * 5);\n        });\n    }\n\n    /**\n     * Sends a message with promise response\n     *\n     * @param payload Payload\n     * @returns Response\n     */\n    private async sendDirectPromiseCommand(payload: string): Promise<LGResponse> {\n        return new Promise((resolve, reject) => {\n            if (!this.isConnected || !this.isRegistered) {\n                reject;\n            }\n            let val: any;\n            try {\n                val = JSON.parse(payload);\n            } catch {\n                reject;\n            }\n            const listener = (event: MessageEvent): any => {\n                try {\n                    const json: LGResponse = JSON.parse(event.data.toString());\n                    if (json.id && json.id === val.id) {\n                        this.ws?.removeEventListener(\"message\", listener);\n                        return resolve(json);\n                    } else if (json.type == \"error\") {\n                        return resolve(json);\n                    }\n                } catch {\n                    return reject;\n                }\n            };\n            this.ws?.addEventListener(\"message\", listener);\n            this.ws?.send(JSON.stringify(payload));\n            this.adapter.setTimeout(() => {\n                this.ws?.removeEventListener(\"message\", listener);\n                reject;\n            }, 1000 * 5);\n        });\n    }\n\n    /**\n     * Sleep\n     *\n     * @param ms milliseconds\n     */\n    private sleep(ms: number): Promise<void> {\n        return new Promise(resolve => {\n            this.delayTimeout = this.adapter.setTimeout(resolve, ms);\n        });\n    }\n\n    /**\n     * Actived MDNS Log\n     */\n    public mdnLog(val: boolean): void {\n        this.adapter.log.debug(`MDN Log: ${val}`);\n        this.log = val;\n    }\n\n    /**\n     * Set ack flag\n     *\n     * @param id ioBroker object id\n     */\n    private async setAckFlag(id: string): Promise<void> {\n        await this.adapter.setState(id, { ack: true });\n    }\n\n    /**\n     * Check response error or response\n     *\n     * @param val find string\n     * @param key key\n     * @returns [string, respCheck] | undefined\n     */\n    private getRespRequestFind(val: string, key: \"id\" | \"uri\" | \"settings\"): [string, respCheck] | undefined {\n        const entry = this.reqResp.find(r => r[1][key] === val);\n        if (entry) {\n            return entry;\n        }\n        return undefined;\n    }\n\n    /**\n     * Check response error or response\n     *\n     * @param val find string\n     * @param key key\n     * @param valSecond find string\n     * @returns [string, respCheck] | undefined\n     */\n    private getRespRequestFindSecond(\n        val: string,\n        key: \"id\" | \"uri\" | \"settings\",\n        valSecond: string,\n    ): [string, respCheck] | undefined {\n        const entry = this.reqResp.find(r => r[1][key] === val && r[1].settings === valSecond);\n        if (entry) {\n            return entry;\n        }\n        return undefined;\n    }\n\n    /**\n     * Find request with 32Bits URI\n     *\n     * @param key V4 UUID\n     * @returns [string, respCheck] | undefined\n     */\n    private getRespRequestKeyFind(key: string): [string, respCheck] | undefined {\n        const entry = this.reqResp.find(r => r[0] === key);\n        if (entry) {\n            return entry;\n        }\n        return undefined;\n    }\n\n    /**\n     * Remove request\n     *\n     * @param uuid V4 UUID\n     */\n    private removeRespCheckUuid(uuid: string): void {\n        this.reqResp = this.reqResp.filter(r => r[0] !== uuid);\n    }\n\n    /**\n     * Set response value\n     *\n     * @param resp TV Response\n     */\n    private setResponseValue(resp: LGResponse): void {\n        if (!resp.id) {\n            this.adapter.log.error(`Unknown error: ${JSON.stringify(resp)}`);\n            return;\n        }\n        const entry = this.getRespRequestKeyFind(resp.id);\n        if (entry && entry[1] != null) {\n            entry[1].response = resp.type;\n            if (resp.type == \"error\") {\n                entry[1].error = resp.error ? resp.error : \"Unknown error\";\n                if (resp.payload && resp.payload.errorCode != undefined) {\n                    entry[1].errorCode = resp.payload.errorCode;\n                }\n                if (resp.payload && resp.payload.errorText != undefined) {\n                    entry[1].errorText = resp.payload.errorText;\n                }\n            } else if (resp.type == \"response\") {\n                if (resp.payload && resp.payload.subscribed) {\n                    entry[1].subscribe = resp.payload.subscribed;\n                }\n            }\n        }\n    }\n\n    /**\n     * Destroy all events\n     */\n    public async destroy(): Promise<void> {\n        if (this.mdn != null) {\n            this.mdn.destroy();\n            this.mdn = null;\n        }\n        if (this.ws != null) {\n            this.ws.close();\n            this.ws = null;\n        }\n        if (this.pointerWebSocket != null) {\n            this.pointerWebSocket.close();\n            this.pointerWebSocket = null;\n        }\n        this.checkOpenMessage();\n        this.v4.clear();\n        this.checkCallback && this.adapter.clearTimeout(this.checkCallback);\n        this.delayTimeout && this.adapter.clearTimeout(this.delayTimeout);\n        this.subscribeChannel && this.adapter.clearTimeout(this.subscribeChannel);\n        this.pointerCheck && this.adapter.clearTimeout(this.pointerCheck);\n        this.checkTVStatus && this.adapter.clearInterval(this.checkTVStatus);\n        this.startWebSocketDelay && this.adapter.clearTimeout(this.startWebSocketDelay);\n        await this.updateStatus(false);\n        await this.updatePointerStatus(false);\n    }\n}\n"],
  "mappings": "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",
  "names": ["mdns", "uuidv4", "_a"]
}
